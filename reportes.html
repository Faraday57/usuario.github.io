<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reportes - Inventario Pro</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">📦</div>
      <div class="brand-text">
        <h2>Inventario Pro</h2>
      </div>
    </div>
    <nav class="nav">
      <a href="menu.html">🏠 Menú Principal</a>
      <a href="inventario.html">📦 Inventario</a>
      <a href="stock.html">📊 Stock</a>
      <a href="facturacion.html">🧾 Facturación</a>
      <a href="reportes.html" class="active">📑 Reportes</a>
    </nav>
    <div class="sidebar-bottom">
      <button id="btnDark" class="dark-toggle">🌙</button>
      <button id="btnLogout" class="logout">Cerrar sesión</button>
    </div>
  </aside>

  <main class="content">
    <header class="topbar">
      <h1>Reportes e Informes</h1>
      <p class="lead">Exporta tu inventario a Excel con formato profesional</p>
    </header>

    <section class="card">
      <h3>📊 Exportar Inventario a Excel</h3>
      <p style="color:var(--muted);margin-bottom:20px;">
        Descarga tu inventario completo en formato <strong>Excel (.xlsx)</strong> con tablas organizadas, formato profesional y resumen automático de estadísticas.
      </p>
      <button onclick="exportarInventario()" class="btn primary" style="font-size:1.05rem;padding:14px 24px;">
        📥 Descargar Excel (.xlsx)
      </button>
    </section>

    <section class="card">
      <h3>📋 Contenido del Archivo Excel</h3>
      <div style="background:rgba(0,0,0,0.2);padding:20px;border-radius:12px;border:var(--glass-border);">
        <p style="margin:0 0 16px 0;color:var(--text-primary);font-weight:600;">
          El archivo Excel incluye las siguientes columnas organizadas:
        </p>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;color:var(--text-muted);line-height:1.8;">
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">📌 Código ID</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Identificador único</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">📦 Nombre</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Producto completo</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">🏢 Empresa</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Proveedor</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">📊 Cantidad</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Stock disponible</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">🎯 Estado</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Nivel de stock</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">📅 Fecha</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Día de registro</p>
          </div>
          <div style="background:rgba(0,170,255,0.1);padding:12px;border-radius:8px;border:1px solid rgba(0,170,255,0.2);">
            <strong style="color:var(--accent);">🕐 Hora</strong>
            <p style="margin:4px 0 0 0;font-size:0.85rem;">Hora de registro</p>
          </div>
        </div>
        
        <div style="margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.1);">
          <p style="margin:0 0 12px 0;color:var(--text-primary);font-weight:600;">
            📈 Resumen Automático al Final:
          </p>
          <ul style="color:var(--text-muted);line-height:1.8;margin:0;padding-left:20px;font-size:0.95rem;">
            <li>Total de productos registrados</li>
            <li>Total de unidades en stock</li>
            <li>Promedio de stock por producto</li>
            <li>Productos en estado crítico</li>
            <li>Productos sin stock</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card">
      <h3>💡 Ventajas del Formato Excel</h3>
      <div class="grid-2" style="gap:16px;">
        <div style="background:rgba(46,204,113,0.15);padding:16px;border-radius:10px;border:1px solid rgba(46,204,113,0.3);">
          <div style="font-size:1.8rem;margin-bottom:8px;">✅</div>
          <strong style="color:#c8ffe0;display:block;margin-bottom:6px;">Formato Nativo</strong>
          <p style="margin:0;color:var(--text-muted);font-size:0.9rem;">
            Archivo .xlsx que se abre directamente en Excel sin conversiones
          </p>
        </div>
        
        <div style="background:rgba(0,170,255,0.15);padding:16px;border-radius:10px;border:1px solid rgba(0,170,255,0.3);">
          <div style="font-size:1.8rem;margin-bottom:8px;">📊</div>
          <strong style="color:#8dd5ff;display:block;margin-bottom:6px;">Tablas Organizadas</strong>
          <p style="margin:0;color:var(--text-muted);font-size:0.9rem;">
            Columnas con anchos optimizados y encabezados claros
          </p>
        </div>
        
        <div style="background:rgba(241,196,15,0.15);padding:16px;border-radius:10px;border:1px solid rgba(241,196,15,0.3);">
          <div style="font-size:1.8rem;margin-bottom:8px;">🔍</div>
          <strong style="color:#fffacd;display:block;margin-bottom:6px;">Filtros y Ordenamiento</strong>
          <p style="margin:0;color:var(--text-muted);font-size:0.9rem;">
            Usa las funciones de Excel para analizar tus datos
          </p>
        </div>
        
        <div style="background:rgba(155,89,182,0.15);padding:16px;border-radius:10px;border:1px solid rgba(155,89,182,0.3);">
          <div style="font-size:1.8rem;margin-bottom:8px;">📱</div>
          <strong style="color:#e8d4ff;display:block;margin-bottom:6px;">Compatible</strong>
          <p style="margin:0;color:var(--text-muted);font-size:0.9rem;">
            Funciona en Excel, Google Sheets, LibreOffice y más
          </p>
        </div>
      </div>
    </section>

    <section class="card">
      <h3>🎯 Estados de Stock en el Reporte</h3>
      <div style="background:rgba(0,0,0,0.2);padding:20px;border-radius:12px;border:var(--glass-border);">
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;">
          <div style="text-align:center;padding:12px;background:rgba(149,165,166,0.1);border-radius:8px;">
            <span class="badge badge-sin" style="margin-bottom:8px;">SIN STOCK</span>
            <p style="margin:8px 0 0 0;color:var(--text-muted);font-size:0.85rem;">0 unidades</p>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(231,76,60,0.1);border-radius:8px;">
            <span class="badge badge-bajo" style="margin-bottom:8px;">CRÍTICO</span>
            <p style="margin:8px 0 0 0;color:var(--text-muted);font-size:0.85rem;">&lt; 30 unidades</p>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(241,196,15,0.1);border-radius:8px;">
            <span class="badge badge-medio" style="margin-bottom:8px;">BAJO</span>
            <p style="margin:8px 0 0 0;color:var(--text-muted);font-size:0.85rem;">30 - 50 unidades</p>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(241,196,15,0.1);border-radius:8px;">
            <span class="badge badge-medio" style="margin-bottom:8px;">MEDIO</span>
            <p style="margin:8px 0 0 0;color:var(--text-muted);font-size:0.85rem;">51 - 100 unidades</p>
          </div>
          <div style="text-align:center;padding:12px;background:rgba(46,204,113,0.1);border-radius:8px;">
            <span class="badge badge-alto" style="margin-bottom:8px;">ALTO</span>
            <p style="margin:8px 0 0 0;color:var(--text-muted);font-size:0.85rem;">&gt; 100 unidades</p>
          </div>
        </div>
      </div>
    </section>

    <section class="card">
      <h3>📖 Instrucciones de Uso</h3>
      <div style="background:rgba(0,0,0,0.2);padding:20px;border-radius:12px;border:var(--glass-border);">
        <ol style="color:var(--text-muted);line-height:2;margin:0;padding-left:20px;">
          <li><strong style="color:var(--text-primary);">Haz clic</strong> en el botón "Descargar Excel"</li>
          <li><strong style="color:var(--text-primary);">Espera</strong> a que se descargue el archivo .xlsx</li>
          <li><strong style="color:var(--text-primary);">Abre</strong> el archivo con Microsoft Excel o tu programa preferido</li>
          <li><strong style="color:var(--text-primary);">Analiza</strong> los datos, aplica filtros u ordena columnas</li>
          <li><strong style="color:var(--text-primary);">Revisa</strong> el resumen al final de la tabla con estadísticas</li>
        </ol>
      </div>
    </section>
  </main>

  <script src="reportes.js"></script>
  <script src="global.js"></script>
</body>
</html>